<!-- HEADER -->
<div
  class="px-4 py-3 flex items-center bg-gradient-to-r from-indigo-950 via-blue-800 to-amber-500 shadow-lg sticky top-0 z-40 border-b border-white/20"
  style="font-family: 'Times New Roman', Times, serif;"
>
  <img
    src="logo.png"
    alt="logo"
    class="w-23 h-auto object-contain drop-shadow-lg rounded-full border-2 border-amber-300 bg-white/80"
  />

  <nav
    class="flex flex-1 ml-6 gap-6 text-white font-semibold text-lg select-none cursor-pointer flex-wrap items-center"
  >
    <!-- === 1. ENLACES PÚBLICOS (Siempre visibles) === -->
    <div
      routerLink="/home"
      id="home-link"
      class="pb-1 border-b border-transparent hover:border-amber-300 hover:text-amber-200 transition-all duration-200"
    >
      Home
    </div>
    <div
      routerLink="/cont"
      id="quienes-somos-link"
      class="pb-1 border-b border-transparent hover:border-amber-300 hover:text-amber-200 transition-all duration-200"
    >
      Quienes Somos
    </div>

    <!-- === 2. ENLACES PROTEGIDOS (Visibles por Rol) === -->

    <div
      *ngIf="authService.hasRole('Administrador')"
      routerLink="/UserGes"
      id="gestion-usuarios-link"
      class="pb-1 border-b border-transparent hover:border-amber-300 hover:text-amber-200 transition-all duration-200"
    >
      Gestión de Usuarios
    </div>

    <div
      *ngIf="authService.hasRole('Administrador')"
      routerLink="/Roles"
      id="gestion-roles-link"
      class="pb-1 border-b border-transparent hover:border-amber-300 hover:text-amber-200 transition-all duration-200"
    >
      Gestión de Roles
    </div>

    <div
      *ngIf="authService.hasRole('Administrador')"
      routerLink="/Menus"
      id="gestion-menus-link"
      class="pb-1 border-b border-transparent hover:border-amber-300 hover:text-amber-200 transition-all duration-200"
    >
      Gestión de Menus
    </div>

    <div
      *ngIf="authService.hasRole('Administrador')"
      routerLink="/AsignacionProcesosMenus"
      id="gestion-menus-procesos-link"
      class="pb-1 border-b border-transparent hover:border-amber-300 hover:text-amber-200 transition-all duration-200"
    >
      Asignacion Procesos a menu
    </div>

    <div
      *ngIf="authService.hasRole('Administrador')"
      routerLink="/AsignacionRolesMenus"
      id="gestion-menus-roles-link"
      class="pb-1 border-b border-transparent hover:border-amber-300 hover:text-amber-200 transition-all duration-200"
    >
      Asignacion Roles a menu
    </div>

    <div
      *ngIf="authService.hasRole('Administrador')"
      routerLink="/AsignacionRolesUsuarios"
      id="gestion-menus-roles-link"
      class="pb-1 border-b border-transparent hover:border-amber-300 hover:text-amber-200 transition-all duration-200"
    >
      Asignacion Roles a usuarios
    </div>

    <div
      *ngIf="authService.hasAnyRole(['Administrador', 'Profesor'])"
      routerLink="/paralelos"
      id="gestion-parlalelos-link"
      class="pb-1 border-b border-transparent hover:border-amber-300 hover:text-amber-200 transition-all duration-200"
    >
      Gestion de paralelos
    </div>

    <div
      *ngIf="authService.hasRole('Administrador')"
      routerLink="/items"
      id="gestion-items-link"
      class="pb-1 border-b border-transparent hover:border-amber-300 hover:text-amber-200 transition-all duration-200"
    >
      Gestion de items
    </div>

    <div
      *ngIf="authService.hasRole('Administrador')"
      routerLink="/materias"
      id="gestion-materias-link"
      class="pb-1 border-b border-transparent hover:border-amber-300 hover:text-amber-200 transition-all duration-200"
    >
      Gestion de materias
    </div>
    
    <div
      *ngIf="authService.hasRole('Administrador')"
      routerLink="/niveles"
      id="gestion-niveles-link"
      class="pb-1 border-b border-transparent hover:border-amber-300 hover:text-amber-200 transition-all duration-200"
    >
      Gestion de niveles
    </div>

    <div
      *ngIf="authService.hasRole('Administrador')"
      routerLink="/asignardicta"
      id="gestion-asignarmateriasprofesor-link"
      class="pb-1 border-b border-transparent hover:border-amber-300 hover:text-amber-200 transition-all duration-200"
    >
      Gestion asignar materias profesor
    </div>

    <div
      *ngIf="authService.hasRole('Administrador')"
      routerLink="/inscripcionAlumnos"
      id="gestion-asignarmateriasalumno-link"
      class="pb-1 border-b border-transparent hover:border-amber-300 hover:text-amber-200 transition-all duration-200"
    >
      Gestion asignar materias alumno
    </div>
    <!-- Select de Roles -->
    <select
      *ngIf="authService.isLoggedIn()"
      name="roles"
      id="roles"
      class="ml-auto min-w-[170px] bg-blue-900/70 text-white rounded-xl px-3 py-1.5 border border-white/30 shadow-sm hover:bg-blue-800/80 focus:outline-none focus:ring-2 focus:ring-amber-300 focus:border-amber-300 transition-all duration-200"
      [ngModel]="selectedRole"
      (ngModelChange)="selectRole($event)"
    >
      <option *ngFor="let rol of login?.roles" [value]="rol">
        {{ rol.nombre }}
      </option>
    </select>
  </nav>
</div>

<!-- HOME -->
<div
  class="content bg-slate-50 text-slate-900 min-h-screen"
  style="padding-top: 90px; padding-bottom: 90px; font-family: 'Times New Roman', Times, serif;"
>
  <router-outlet></router-outlet>
</div>

<!-- FOOTER -->
<div
  class="bg-gradient-to-r from-indigo-950 via-blue-800 to-amber-500 fixed bottom-0 w-full flex justify-between items-center px-6 py-3 shadow-inner border-t border-white/25"
  style="font-family: 'Times New Roman', Times, serif;"
>
  <div>
    <span class="text-white font-semibold">
      <ng-container *ngIf="!authService.isLoggedIn()">Usuario: Invitado</ng-container>
      <ng-container *ngIf="authService.isLoggedIn()">Usuario: {{ login?.nombre }}</ng-container>
    </span>
  </div>

  <div>
    <span class="text-sm text-amber-200/90">Jhair Eudal Cardozo Garzon</span>
  </div>

  <div class="flex items-center gap-4">
    <span class="text-white/90 text-sm">
      <ng-container *ngIf="!login">
        {{ fechaActual | date:"EEEE, d 'de' MMMM 'de' y" }}
      </ng-container>
      <ng-container *ngIf="login">
        {{ login.fecha | date:"EEEE, d 'de' MMMM 'de' y " }}
      </ng-container>
    </span>

    <button
      *ngIf="!authService.isLoggedIn()"
      class="bg-white text-blue-900 px-3 py-1.5 rounded-lg text-sm font-semibold shadow hover:bg-slate-100 focus:ring-2 focus:ring-amber-300 transition"
      (click)="openModal()"
    >
      Conectar Usuario
    </button>

    <button
      *ngIf="authService.isLoggedIn()"
      class="bg-white/10 border border-white/40 text-white px-3 py-1.5 rounded-lg text-sm font-semibold hover:bg-white/15 focus:ring-2 focus:ring-amber-300 transition"
      (click)="logout()"
    >
      Desconectar Usuario
    </button>
  </div>
</div>

<!-- MODAL DE LOGIN -->
<div
  *ngIf="modalOpen"
  class="fixed inset-0 z-50"
  style="font-family: 'Times New Roman', Times, serif;"
>
  <!-- Fondo -->
  <div class="absolute inset-0 bg-slate-950/70 backdrop-blur-sm"></div>

  <!-- Contenedor centrado -->
  <div class="relative min-h-full flex items-center justify-center p-4">
    <form
      class="w-full max-w-md bg-gradient-to-b from-blue-900 via-slate-950 to-slate-950 text-white rounded-3xl shadow-2xl p-6 border border-white/20"
      (ngSubmit)="ingreso_sistema()"
    >
      <div class="flex justify-between items-center mb-4">
        <h4 class="text-xl font-bold tracking-wide">
          INICIAR SESIÓN
        </h4>
        <button
          type="button"
          class="text-white/80 hover:text-white focus:outline-none"
          (click)="cancelar()"
          aria-label="Cerrar modal"
        >
          ✕
        </button>
      </div>

      <div class="mb-4">
        <label class="block mb-1 font-semibold">Usuario</label>
        <input
          type="text"
          [(ngModel)]="usuario"
          name="usuario"
          class="w-full px-3 py-2 rounded-lg border border-white/40 bg-white/10 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-amber-300 focus:bg-blue-950/40"
          autocomplete="username"
          required
          placeholder="Ingresa tu usuario"
        />
      </div>

      <div class="mb-6">
        <label class="block mb-1 font-semibold">Password</label>
        <input
          type="password"
          [(ngModel)]="password"
          name="password"
          class="w-full px-3 py-2 rounded-lg border border-white/40 bg-white/10 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-amber-300 focus:bg-blue-950/40"
          autocomplete="current-password"
          required
          placeholder="••••••••"
        />
      </div>

      <div class="flex gap-3">
        <button
          type="submit"
          class="flex-1 bg-amber-400 text-blue-950 font-bold px-4 py-2 rounded-lg shadow hover:bg-amber-300 focus:ring-2 focus:ring-amber-300 transition"
        >
          Ingresar
        </button>
        <button
          type="button"
          class="bg-transparent border border-white/50 px-4 py-2 rounded-lg text-white hover:bg-white/10 focus:ring-2 focus:ring-amber-300 transition"
          (click)="cancelar()"
        >
          Cancelar
        </button>
      </div>
    </form>
  </div>
</div>
